<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard T·ª´ V·ª±ng</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 font-sans flex items-center justify-center min-h-screen p-4">
    <div class="max-w-md w-full bg-white rounded-2xl shadow-lg p-6 text-center">
        <h1 class="text-2xl font-bold mb-4 text-blue-600">üìö Flashcard HSK for Ng·ªçc Di·ªÖm</h1>

        <div id="card"
            class="relative bg-blue-50 rounded-xl p-6 h-48 flex items-center justify-center text-xl font-semibold cursor-pointer transition-all duration-500">
            Loading....
        </div>

        <div class="mt-4 flex justify-between items-center">
            <!-- <button onclick="prevCard()" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">‚¨ÖÔ∏è</button> -->
            <button onclick="playAudio()" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">üîä Ph√°t √¢m</button>
            <button onclick="nextCard()" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">T·ª´ kh√°c</button>
        </div>

        <div class="mt-4">
            <button onclick="remember(true)" class="px-4 py-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200">‚¨ÜÔ∏è
                Nh·ªõ r√πi</button>
            <!-- <button onclick="remember(false)" class="px-4 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200 ml-2">‚ùå
                T√¥i qu√™n</button> -->
        </div>

        <p class="mt-4 text-gray-600" id="progress">Th·∫ª 1 / 3</p>
        <div id="stats" class="text-sm text-gray-600 mt-2">
            ‚úÖ Nh·ªõ: <span id="count-remembered">0</span> |
            ‚ùå Qu√™n: <span id="count-forgotten">0</span>
        </div>
    </div>

    <script>
        let rememberedCount = 0;
        let forgottenCount = 0;
        let cards = [];
        let current = 0;
        let flipped = false;
        async function fetchVocabulary() {
            try {
                const res = await fetch("https://raw.githubusercontent.com/clem109/hsk-vocabulary/master/hsk-vocab-json/hsk-level-4.json");

                const data = await res.json();
                cards = data.map(item => ({
                    word: item.hanzi,
                    meaning: item.pinyin,
                    example: `Nghƒ©a: ${item.translations[0]==undefined?"":"<br>-"+item.translations[0]}${item.translations[1]==undefined?"":"<br>-"+item.translations[1]}${item.translations[2]==undefined?"":"<br>-"+item.translations[2]}${item.translations[3]==undefined?"":"<br>-"+item.translations[3]}.`
                }));
                current = 0;
                flipped = false;
                updateCard();
                updateStats();
            } catch (err) {
                console.error("L·ªói khi t·∫£i d·ªØ li·ªáu:", err);
                card.innerHTML = "<span class='text-red-500'>Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu.</span>";
            }
        }
        // async function fetchVocabulary() {
        //     try {
        //         // https://github.com/drkameleon/complete-hsk-vocabulary/tree/main
        //         // https://github.com/clem109/hsk-vocabulary/blob/master/hsk-vocab-json/hsk-level-5.json
        //         const res = await fetch("https://raw.githubusercontent.com/huynhat1905/json-dictionary/main/chinese-vocab-basic.jsonhttps://raw.githubusercontent.com/phucnhapp/pukn/refs/heads/main/tiengtrung.json?token=GHSAT0AAAAAADBM6L3XACBRWRP5DRY3DY3YZ7UZT6Q");
        //         const data = await res.json();
        //         cards = data;
        //         current = 0;
        //         flipped = false;
        //         updateCard();
        //     } catch (err) {
        //         console.error("L·ªói khi t·∫£i d·ªØ li·ªáu:", err);
        //         card.innerHTML = "<span class='text-red-500'>Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu.</span>";
        //     }
        // }
        fetchVocabulary();
        // const cards = [
        //     { word: "‰Ω†Â•Ω", meaning: "Xin ch√†o", example: "That was an incredible game!" },
        //     { word: "commitment", meaning: "s·ª± cam k·∫øt", example: "He showed real commitment to his work." },
        //     { word: "reliable", meaning: "ƒë√°ng tin c·∫≠y", example: "She is a very reliable friend." }
        // ];

        // let current = 0;
        // let flipped = false;

        const card = document.getElementById("card");
        const progress = document.getElementById("progress");

        card.addEventListener("click", () => {
            flipped = !flipped;
            updateCard();
        });

        function updateCard() {
            const item = cards[current];
            card.innerHTML = flipped
                ? `<div><div class='text-lg'>${item.meaning}</div><div class='text-sm mt-2 text-gray-600 italic'>${item.example}</div></div>`
                : item.word;
            progress.textContent = `Th·∫ª ${current + 1} / ${cards.length}`;
        }

        function nextCard() {
            if (cards.length <= 1) return; // Kh√¥ng l√†m g√¨ n·∫øu ch·ªâ c√≤n 1 th·∫ª
            let next;
            do {
                next = Math.floor(Math.random() * cards.length);
            } while (next === current); // ƒê·∫£m b·∫£o kh√¥ng tr√πng v·ªõi th·∫ª hi·ªán t·∫°i
            current = next;
            flipped = false;
            updateCard();
        }

        function prevCard() {
            current = (current - 1 + cards.length) % cards.length;
            flipped = false;
            updateCard();
        }
        function updateStats() {
            document.getElementById("count-remembered").textContent = rememberedCount;
            document.getElementById("count-forgotten").textContent = forgottenCount;
        }
        function remember(isRemembered) {
            // alert(isRemembered ? "Tuy·ªát! B·∫°n ƒë√£ nh·ªõ." : "Kh√¥ng sao, √¥n l·∫°i sau nh√©!");
            if (isRemembered) {
                rememberedCount++;
                cards.splice(current, 1);
                if (cards.length === 0) {
                    card.innerHTML = "<span class='text-green-600 text-lg'>üéâ B·∫°n ƒë√£ nh·ªõ h·∫øt c√°c t·ª´!</span>";
                    progress.textContent = "";
                    document.getElementById("stats").textContent = `‚úÖ Nh·ªõ: ${rememberedCount} | ‚ùå Qu√™n: ${forgottenCount}`;
                    return;
                }
                if (current >= cards.length) current = 0;
                flipped = false;
                updateCard();
            } else {
                forgottenCount++;
                alert("Kh√¥ng sao, √¥n l·∫°i sau nh√©!");
            }
            updateStats();
        }

        function playAudio() {
            const utter = new SpeechSynthesisUtterance(cards[current].word);
            utter.lang = "zh-CN";
            //   utter.lang = "en-US";
            speechSynthesis.speak(utter);
        }

        updateCard();
    </script>
</body>

</html>
